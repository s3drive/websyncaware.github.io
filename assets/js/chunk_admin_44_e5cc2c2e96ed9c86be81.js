(window.webpackJsonp=window.webpackJsonp||[]).push([[44,48],{447:function(e,t,n){"use strict";n.r(t),n.d(t,"bcrypt_password",(function(){return o}));var a=n(448),r=n.n(a);function o(e){return new Promise((function(t,n){r.a.hash(e,10,(function(e,a){if(e)return n(e);t(a)}))}))}},453:function(e,t){},454:function(e,t){},463:function(e,t){},464:function(e,t){},484:function(e,t){},486:function(e,t){},487:function(e,t){},490:function(e,t){},491:function(e,t){},496:function(e,t){},497:function(e,t){},505:function(e,t){},511:function(e,t){},514:function(e,t){},581:function(e,t,n){var a=n(582);"string"==typeof a&&(a=[[e.i,a,""]]);n(7)(a,{hmr:!0,transform:void 0,insertInto:void 0}),a.locals&&(e.exports=a.locals)},582:function(e,t,n){(e.exports=n(6)(!1)).push([e.i,".component_page_admin{display:flex}.component_page_admin .adminpage{max-width:1400px}.component_page_admin .page_container{width:100%;background:var(--super-light);padding-bottom:150px;padding-left:60px;padding-right:60px;box-sizing:border-box;max-height:100vh}@media screen and (max-width: 1000px){.component_page_admin .page_container{padding-left:30px;padding-right:30px}}@media screen and (max-width: 500px){.component_page_admin .page_container{padding-left:10px;padding-right:10px}}.component_page_admin .page_container h2{font-family:'Source Code Pro', monospace;text-shadow:0 0 2px var(--bg-color);font-size:2em;padding:50px 0 0 0;margin-bottom:30px;margin-top:0;font-weight:300;line-height:1em}@media screen and (max-width: 1000px){.component_page_admin .page_container h2{padding:25px 0 0 0}}@media screen and (max-width: 500px){.component_page_admin .page_container h2{padding:10px 0 0 0}}.component_page_admin .page_container h2:after{content:\"_\";display:block;font-size:0;border-bottom:3px solid var(--color);width:90px;margin-top:5px;opacity:0.9;line-height:0}.component_page_admin .page_container .sticky h2{position:sticky;background:var(--super-light);z-index:2;top:0}.component_page_admin .page_container label>div{display:flex}@media screen and (max-width: 550px){.component_page_admin .page_container label>div{display:block}.component_page_admin .page_container label>div .nothing{display:none}}.component_page_admin .page_container label>div>span{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block;line-height:30px;min-width:150px;padding-right:20px;margin-top:auto;margin-bottom:auto}@media screen and (max-width: 760px){.component_page_admin .page_container label>div>span{min-width:115px}}.component_page_admin .page_container a{color:var(--dark);border-bottom:1px dashed var(--dark)}.component_page_admin .page_container pre{font-family:'Source Code Pro', monospace;background:var(--dark);font-size:0.9em;padding:10px;margin-bottom:0;border-radius:2px;color:white;max-width:100%;overflow-x:auto;overflow-y:auto}.component_page_admin .page_container .component_loader>svg{height:50px}.component_page_admin .page_container fieldset{background:white;border-color:var(--bg-color);border-style:solid;border-radius:3px;margin:15px 0}.component_menu_sidebar{height:100vh;background:linear-gradient(#313538, var(--dark));width:250px;border-right:2px solid var(--color);padding:50px 0px 0px 40px;transition:transform 0.3s ease;transition-delay:0.7s}.component_menu_sidebar h2{font-family:'Source Code Pro', monospace;color:white;font-weight:300;font-size:1.5em;margin:25px 0 40px 0}.component_menu_sidebar ul{color:rgba(255,255,255,0.5);list-style-type:none;padding:0}.component_menu_sidebar ul li{margin:15px 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.component_menu_sidebar ul li a.active,.component_menu_sidebar ul li a:hover{color:white}.component_menu_sidebar .header{display:block;height:40px}.component_menu_sidebar .header img{width:40px;height:40px}.component_menu_sidebar .header img[alt=\"arrow_left\"]{position:absolute;margin-left:-35px;opacity:0.7;padding:8px;box-sizing:border-box}@media screen and (max-width: 760px){.component_menu_sidebar .header img[alt=\"arrow_left\"]{display:none}}@media screen and (max-width: 1000px){.component_menu_sidebar{padding-left:30px;width:200px}.component_menu_sidebar h2{font-size:1.35em}}@media screen and (max-width: 760px){.component_menu_sidebar{padding:25px 10px}.component_menu_sidebar h2{margin:15px 0 25px 0;font-size:1.25em;padding:0}}@media screen and (max-width: 650px){.component_menu_sidebar{width:inherit;padding:25px 10px}.component_menu_sidebar h2{display:none}}@media screen and (max-width: 440px){.component_menu_sidebar{padding:5px 5px}.component_menu_sidebar ul li{width:50px}}.adminpage-appear{transition:transform 0.3s ease, opacity 0.5s ease;opacity:0;transform:translateX(5px)}.adminpage-appear.adminpage-appear-active{opacity:1;transform:translateX(0px)}\n",""])},583:function(e,t,n){var a=n(584);"string"==typeof a&&(a=[[e.i,a,""]]);n(7)(a,{hmr:!0,transform:void 0,insertInto:void 0}),a.locals&&(e.exports=a.locals)},584:function(e,t,n){(e.exports=n(6)(!1)).push([e.i,'.component_dashboard .box-container{display:flex;flex-wrap:wrap;margin:-5px -5px 20px -5px}.component_dashboard .box-container .box-item{position:relative;width:20%}@media (max-width: 1350px){.component_dashboard .box-container .box-item{width:25%}}@media (max-width: 900px){.component_dashboard .box-container .box-item{width:33.33%}}@media (max-width: 750px){.component_dashboard .box-container .box-item{width:50%}}.component_dashboard .box-container .box-item>div{box-shadow:2px 2px 10px rgba(0,0,0,0.25);margin:3px;padding:30px 0;text-align:center;color:rgba(0,0,0,0.3);text-shadow:0px 0px 1px var(--color);font-size:1.1em;text-transform:uppercase;border-radius:2px;background:var(--light)}@media (max-width: 900px){.component_dashboard .box-container .box-item>div{padding:25px 0}}@media (max-width: 750px){.component_dashboard .box-container .box-item>div{padding:20px 0}}.component_dashboard .box-container .box-item>div>span{display:none}.component_dashboard .box-container .box-item>div:hover>span{display:block;cursor:pointer;position:absolute;top:0px;right:0px;left:0;bottom:0;font-size:2.3rem;font-family:monospace;line-height:25px;color:var(--color);text-shadow:none;background:var(--emphasis-primary);padding:18px 0;margin:6px;opacity:0.95}@media (max-width: 900px){.component_dashboard .box-container .box-item>div:hover>span{padding:12px 0}}@media (max-width: 750px){.component_dashboard .box-container .box-item>div:hover>span{padding:7px 0}}.component_dashboard .box-container .box-item>div:hover>span .icon{background:var(--primary);border-radius:50%;width:40px;height:40px;display:inline-block;line-height:40px;opacity:0.6;color:white}.component_dashboard .box-container .box-item>div:hover>span .icon .component_icon{padding:7px;width:25px;height:25px}.component_dashboard .box-container .box-item.active>div{background:var(--primary);transition:background 0.1s}.component_dashboard .box-container .box-item.pointer{cursor:pointer}.component_dashboard .box-container .box-item.no-select{user-select:none}.component_dashboard form>div{position:relative}.component_dashboard form>div>.icons{position:absolute;border-radius:50%;padding:10px;border:3px solid var(--bg-color);background:var(--primary);cursor:pointer;right:-15px;top:-5px}.component_dashboard form>div>.icons .component_icon{height:20px}.component_dashboard .authentication-middleware .formbuilder label span>input[type="checkbox"]{display:none}\n',""])},585:function(e,t,n){var a=n(586);"string"==typeof a&&(a=[[e.i,a,""]]);n(7)(a,{hmr:!0,transform:void 0,insertInto:void 0}),a.locals&&(e.exports=a.locals)},586:function(e,t,n){(e.exports=n(6)(!1)).push([e.i,".component_logpage button{width:inherit;float:right;margin-top:5px;padding-left:20px;padding-right:20px}\n",""])},675:function(e,t,n){var a=n(676);"string"==typeof a&&(a=[[e.i,a,""]]);n(7)(a,{hmr:!0,transform:void 0,insertInto:void 0}),a.locals&&(e.exports=a.locals)},676:function(e,t,n){(e.exports=n(6)(!1)).push([e.i,'.component_setup{transform:none !important}.component_setup h4{user-select:none;text-align:center;font-size:1.4em;font-weight:500;padding:20px 0 0px 0}.component_setup h4 .component_icon{vertical-align:text-top;width:1.3em;cursor:pointer}.component_setup h4 .component_icon[alt="loading"]{opacity:0}.component_setup #step1 p{font-size:1.1em;margin-bottom:10px}.component_setup #step1 form{max-width:400px}.component_setup #step1 form{display:flex;background:white;border-radius:2px;box-shadow:2px 2px 2px rgba(0,0,0,0.05)}.component_setup #step1 form input{padding:15px 20px;border-bottom:0;margin:0}.component_setup #step1 form button{width:inherit;padding:0 10px}.component_setup #step1 form button .component_icon{height:25px}.component_setup #step2 .component_dependency_installed{margin:10px 0;padding:10px 10px;border-radius:3px;color:rgba(0,0,0,0.6)}.component_setup #step2 .component_dependency_installed.yes{background:var(--success)}.component_setup #step2 .component_dependency_installed.no{background:var(--primary)}.component_setup #step2 .component_dependency_installed.no.severe{background:var(--error)}.component_setup #step2 .component_dependency_installed.no.severe span{font-weight:bold;font-style:italic}.component_setup .stepper-form-appear,.component_setup .stepper-form-enter{transition-delay:0.3s;transform:scale(1.02);opacity:0;transition:all 0.3s ease}.component_setup .stepper-form-appear.stepper-form-appear-active,.component_setup .stepper-form-appear.stepper-form-enter-active,.component_setup .stepper-form-enter.stepper-form-appear-active,.component_setup .stepper-form-enter.stepper-form-enter-active{opacity:1;transform:scale(1)}.component_setup .component_icon{width:30px}\n',""])},840:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(8),i=n(12),c=(n(27),n(581),n(2)),l=n(4),s=n(1);function u(){return r.a.createElement(o.a,{to:"/admin/backend"})}var p=n(3);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n(583);var m=["type"],f=["related_backend"];function b(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o=[],i=!0,c=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(c)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function x(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(n,r.a.Component);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=E(e);if(t){var r=E(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}(n);function n(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).state={backend_enabled:[],backend_available:{},auth_enabled:null,auth_available:{},config:null,isLoading:!0},a}return function(e,t,n){t&&x(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(n,[{key:"componentDidMount",value:function(){var e=this;Promise.all([l.b.all(),l.c.all(),l.f.getAllAuthentication()]).then((function(t){var n=y(t,3),a=n[0],r=n[1],o=n[2];delete r.constants,e.setState({isLoading:!1,backend_available:a,backend_enabled:window.CONFIG.connections.filter((function(e){return e})).map((function(e){var t=Object(s.q)(a,e);return 0===Object.keys(t).length?null:t})).filter((function(e){return null!==e})),config:r,auth_available:o,auth_enabled:{identity_provider:function(){var e=Object(s.G)(r,["middleware","identity_provider"])||{},t=e.type,n=e.params;if(t=Object(s.G)(t,["value"]),n=Object(s.G)(n,["value"]),!t)return{};var a=JSON.parse(n),i=o[t]||{},c=null;for(c in a)i[c]&&(i[c].value=a[c]);return i}(),attribute_mapping:function(e){var t=Object(s.G)(r,["middleware","attribute_mapping"])||{},n=t.related_backend,o=t.params,i=void 0===o?{}:o;n=Object(s.G)(n,["value"]),i=JSON.parse(Object(s.G)(i,["value"])||"{}");var c=Object.keys(i).reduce((function(e,t){var n=Object(s.q)(a,i[t]);return e[t]=n[i[t].type],e}),{});return g({related_backend:{label:"Related Backend",type:"text",description:"List of backends to have behind the authentication process. Can be either a backend type of the actual label",placeholder:"eg: ftp,sftp,webdav",readonly:!1,default:null,value:n,multi:!0,datalist:window.CONFIG.connections.map((function(e){return e.label})),required:!0}},c)}()}})}))}},{key:"componentWillUnmount",value:function(){this.props.isSaving(!1),l.c.clear()}},{key:"refresh",value:function(){this.setState({refresh:Math.random()})}},{key:"_buildConfig",value:function(){var e=Object(s.a)(this.state.config);return e.connections=this.state.backend_enabled.map((function(e){var t=Object(s.a)(e,(function(e,t){!0===e[t].enabled?e[t]=e[t].value||e[t].default:delete e[t]}));return t[Object.keys(t)[0]]})),e}},{key:"onUpdateStorageBackend",value:function(e){var t=this;this.refresh();var n=this._buildConfig();return this.props.isSaving(!0),l.c.save(n,!0,(function(){t.props.isSaving(!1)}),(function(e){s.F.send(e&&e.message||Object(p.a)("Oops"),"error"),t.props.isSaving(!1)}))}},{key:"onUpdateAuthenticationMiddleware",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.refresh();var n=this._buildConfig();return n.middleware={identity_provider:function(){var e=Object(s.G)(t,["identity_provider"])||{},n=e.type,a=b(e,m);return{type:n||null,params:JSON.stringify(a)}}(),attribute_mapping:function(){var e=Object(s.G)(t,["attribute_mapping"])||{},n=e.related_backend,a=void 0===n?null:n,r=b(e,f),o={related_backend:a||"N/A"};return Object.keys(r).length>0&&(o.params=JSON.stringify(r,(function(e,t){if(null!==t)return t}))),o}()},this.props.isSaving(!0),l.c.save(n,!0,(function(){e.props.isSaving(!1)}),(function(t){s.F.send(t&&t.message||Object(p.a)("Oops"),"error"),e.props.isSaving(!1)}))}},{key:"addBackend",value:function(e){this.setState({backend_enabled:this.state.backend_enabled.concat(Object(s.q)(this.state.backend_available,{type:e,label:e.toUpperCase()}))},this.onUpdateStorageBackend.bind(this))}},{key:"removeBackend",value:function(e){this.setState({backend_enabled:this.state.backend_enabled.filter((function(t,n){return n!==e}))},this.onUpdateStorageBackend.bind(this))}},{key:"changeAuthentication",value:function(e){var t=this;this.setState({auth_enabled:{identity_provider:null===e?{}:this.state.auth_available[e],attribute_mapping:Object(s.G)(this.state.auth_enabled,["attribute_mapping"])||{}}},(function(){t.onUpdateAuthenticationMiddleware(Object(s.a)(t.state.auth_enabled))}))}},{key:"render",value:function(){var e=this,t=function(t,n,a,o){var i=r.a.createElement(c.s,{type:"checkbox",checked:function(e){return"string"==typeof e.value?(e.enabled=!0,!0):!!e.enabled}(a),style:{width:"inherit",marginRight:"6px",top:"6px"},onChange:function(t){return o(function(t,n){n.enabled=t,e.refresh(),!1===t&&(n.value=null)}.bind(e,t.target.checked))}});return("label"===a.label||!0===a.readonly)&&(i=null),r.a.createElement("label",{className:"no-select input_type_"+n.params.type},r.a.createElement("div",null,r.a.createElement("span",null,i,Object(s.w)(a.label),":"),r.a.createElement("div",{style:{width:"100%"}},t)),r.a.createElement("div",null,r.a.createElement("span",{className:"nothing"}),r.a.createElement("div",{style:{width:"100%"}},a.description?r.a.createElement("div",{className:"description"},a.description):null)))};return r.a.createElement("div",{className:"component_dashboard"},this.state.isLoading?r.a.createElement(c.t,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(k,{backend_available:this.state.backend_available,backend_enabled:this.state.backend_enabled,backend_add:this.addBackend.bind(this),backend_remove:this.removeBackend.bind(this),formChange:this.onUpdateStorageBackend.bind(this),formRender:t}),r.a.createElement(j,{authentication_available:this.state.auth_available,authentication_enabled:this.state.auth_enabled,authentication_update:this.changeAuthentication.bind(this),backend_available:this.state.backend_available,backend_enabled:this.state.backend_enabled,formChange:this.onUpdateAuthenticationMiddleware.bind(this),formRender:t})))}}]),n}();function k(e){var t=e.backend_available,n=e.backend_enabled,a=e.backend_add,o=e.backend_remove,i=e.formChange,l=e.formRender;return r.a.createElement("div",{className:"component_storagebackend"},r.a.createElement("h2",null,"Storage Backend"),r.a.createElement("div",{className:"box-container"},Object.keys(t).sort((function(e,t){return e>t})).map((function(e,t){return r.a.createElement("div",{key:t,onClick:function(){return a(e)},className:"box-item pointer no-select"+(function(e){return-1!==n.map((function(e){return Object.keys(e)[0]})).indexOf(e)}(e)?" active":"")},r.a.createElement("div",null,e,r.a.createElement("span",{className:"no-select"},r.a.createElement("span",{className:"icon"},"+"))))}))),0!==n.length?r.a.createElement("div",null,r.a.createElement("form",null,n.map((function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("div",{className:"icons no-select",onClick:function(){return o(t)}},r.a.createElement(c.r,{name:"close"})),r.a.createElement(c.q,{onChange:i,idx:t,key:t,form:{"":e},render:l}))})))):r.a.createElement(c.a,{className:"error"},"There is no storage selected. Where do you want to connect to?"))}function j(e){var t=e.authentication_available,n=e.authentication_enabled,o=e.backend_available,i=e.backend_enabled,l=e.authentication_update,u=e.formChange,p=e.formRender,d=y(Object(a.useState)(n),2),m=d[0],f=d[1];Object(a.useEffect)((function(){f(n)}),[n]),Object(a.useEffect)((function(){if(m.identity_provider){for(var e=(m.attribute_mapping.related_backend.value||"").split(/, ?/).map((function(e){return e.trim()})),t=m.identity_provider,n=m.attribute_mapping,a=i.map((function(e){return{label:e[Object.keys(e)[0]].label.value,type:Object.keys(e)[0]}})),r=!1,c=0;c<a.length;c++)if(!n[a[c].label])for(var l=0;l<e.length;l++)a[c].label===e[l]&&(n[a[c].label]=JSON.parse(JSON.stringify(o[a[c].type])),r=!0);if(Object.keys(m.attribute_mapping).map((function(t){"related_backend"!==t&&-1===e.indexOf(t)&&(r=!0,delete n[t])})),!1!==r){var p={identity_provider:t,attribute_mapping:n};u(Object(s.a)(p)),f(p)}}}),[m.attribute_mapping.related_backend.value,!m.identity_provider]),Object(a.useEffect)((function(){var e=g({},m);e.attribute_mapping.related_backend.datalist=i.map((function(e){return e[Object.keys(e)[0]].label.value}));var t=i.map((function(e){return e[Object.keys(e)[0]].label.value}));e.attribute_mapping.related_backend.value=(e.attribute_mapping.related_backend.value||"").split(/, ?/).filter((function(e){return-1!==t.indexOf(e)})).join(", "),f(e)}),[i]);var b=function(e){return e===Object(s.G)(n,["identity_provider","type","value"])};return 0===Object.keys(t).length?null:r.a.createElement("div",{className:"component_authenticationmiddleware",style:{minHeight:"400px"}},r.a.createElement("h2",null,"Authentication Middleware"),r.a.createElement("div",{className:"box-container"},Object.keys(t).map((function(e){return r.a.createElement("div",{key:e,onClick:function(){return l(b(e)?null:e)},className:"box-item pointer no-select"+(b(e)?" active":"")},r.a.createElement("div",null,e,r.a.createElement("span",{className:"no-select"},r.a.createElement("span",{className:"icon"},!1===b(e)?"+":r.a.createElement(c.r,{name:"delete"})))))}))),Object(s.G)(n,["identity_provider","type"])&&r.a.createElement("div",{className:"authentication-middleware"},r.a.createElement(c.q,{onChange:function(e){u(e[""])},form:{"":m},render:p})))}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function C(e){var t=e.isSaving,n=void 0===t?s.E:t,o=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o=[],i=!0,c=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(c)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Object(a.useState)({}),2),i=o[0],u=o[1],d=Object(a.useState)(null)[1];return Object(a.useEffect)((function(){return l.c.all().then((function(e){delete e.constant,delete e.middleware,u(e)})),function(){l.c.clear(),n(!1)}}),[]),r.a.createElement("form",{className:"sticky"},r.a.createElement(c.q,{form:i,onChange:function(e){e.connections=window.CONFIG.connections,delete e.constant,d(Math.random()),n(!0),l.c.save(e,!0,(function(){n(!1)}),(function(e){n(!1),s.F.send(e&&e.message||Object(p.a)("Oops"),"error")}))},autoComplete:"new-password",render:function(e,t,n,a){return r.a.createElement("label",{className:"no-select input_type_"+t.params.type},r.a.createElement("div",null,r.a.createElement("span",null,function(e){return"string"!=typeof e?"N/A":e.split("_").map((function(e){return e.length<1?e:e[0].toUpperCase()+e.substring(1)})).join(" ")}(n.label),":"),r.a.createElement("div",{style:{width:"100%"}},e)),r.a.createElement("div",null,r.a.createElement("span",{className:"nothing"}),r.a.createElement("div",{style:{width:"100%"}},n.description&&r.a.createElement("div",{className:"description"},n.description))))}}))}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o=[],i=!0,c=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(c)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function P(e){var t=e.isSaving,n=void 0===t?s.E:t,o=A(Object(a.useState)(""),2),i=o[0],u=o[1],d=A(Object(a.useState)({}),2),m=d[0],f=d[1],b=A(Object(a.useState)({}),2),h=b[0],g=b[1],v=Object(a.useRef)(),y=function(){l.e.get(102400).then((function(e){u(e+"\n\n\n\n\n"),0===v.current.scrollTop&&(v.current.scrollTop=v.current.scrollHeight)})).catch((function(e){u(e&&e.message||Object(p.a)("Oops"))}))};return Object(a.useEffect)((function(){l.c.all().then((function(e){f({"":{params:e.log}}),g(Object(s.a)(e))})),y();var e=setInterval(y,5e3);return function(){clearInterval(e),l.c.clear(),n(!1)}}),[]),r.a.createElement("div",{className:"component_logpage"},r.a.createElement("h2",null,"Logging"),r.a.createElement("div",{style:{minHeight:"150px"}},r.a.createElement(c.q,{form:m,onChange:function(e){var t=Object.assign({},h);t.log=e[""].params,t.connections=window.CONFIG.connections,delete t.constant,n(!0),l.c.save(t,!0,(function(){n(!1)}),(function(){n(!1),s.F.send(err&&err.message||Object(p.a)("Oops"),"error")}))},render:function(e,t,n,a){return r.a.createElement("label",{className:"no-select input_type_"+t.params.type},r.a.createElement("div",null,r.a.createElement("span",null,Object(s.w)(n.label),":"),r.a.createElement("div",{style:{width:"100%"}},e)),r.a.createElement("div",null,r.a.createElement("span",{className:"nothing"}),r.a.createElement("div",{style:{width:"100%"}},n.description&&r.a.createElement("div",{className:"description"},n.description))))}})),r.a.createElement("pre",{style:{height:"350px"},ref:v},""===i?r.a.createElement(c.t,null):i),r.a.createElement("div",null,r.a.createElement("a",{href:l.e.url(),download:function(){var e=(new Date).toISOString().substring(0,10).replace(/-/g,"");return"access_".concat(e,".log")}()},r.a.createElement(c.d,{className:"primary"},"Download"))))}n(585);var I=n(10),T=n.n(I),R=n(447);function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function D(e,t,n){return t&&B(e.prototype,t),n&&B(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function L(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&function(e,t){(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=U(e);if(t){var r=U(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===G(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n(675);var z=function(e){L(n,r.a.Component);var t=M(n);function n(e){var a;return F(this,n),(a=t.call(this,e)).state={busy:!1},a}return D(n,[{key:"componentDidMount",value:function(){var e=this;l.c.all().then((function(t){!0!==t.log.telemetry.value&&(e.unlisten=e.props.history.listen((function(n,a){e.unlisten(),s.j.now(r.a.createElement("div",null,r.a.createElement("p",{style:{textAlign:"justify"}},"Help making this software better by sending crash reports and anonymous usage statistics"),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.props.history.push("/")}.bind(e),style:{fontSize:"0.9em",marginTop:"10px"}},r.a.createElement("label",null,r.a.createElement(c.s,{type:"checkbox",style:{width:"inherit",marginRight:"10px"},onChange:function(t){return e.enableLog(t.target.checked)},defaultChecked:t.log.telemetry.value}),"I accept but the data is not to be share with any third party"))))})))}))}},{key:"onAdminPassword",value:function(e,t){var n=this;this.setState({busy:!0}),l.c.all().then((function(a){return Object(R.bcrypt_password)(e).then((function(r){(a=Object(s.a)(a)).connections=window.CONFIG.connections,a.auth.admin=r,l.c.save(a,!1).then((function(){return l.a.login(e)})).then((function(){return n.setState({busy:!1},t)})).catch((function(e){n.setState({busy:!1}),s.F.send(e&&e.message,"error")}))})).catch((function(e){n.setState({busy:!1}),s.F.send("Hash error: "+JSON.stringify(e),"error")}))})).catch((function(e){s.F.send(e&&e.message,"error"),n.setState({busy:!1})}))}},{key:"enableLog",value:function(e){l.c.all().then((function(t){(t=Object(s.a)(t)).connections=window.CONFIG.connections,t.log.telemetry=e,l.c.save(t,!1)}))}},{key:"summaryCall",value:function(){var e=this;return this.setState({busy:!0}),l.c.all().then((function(t){return e.setState({busy:!1}),[{name_success:"SSL is configured properly",name_failure:"SSL is not configured properly",pass:"http:"!==window.location.protocol,severe:!0,message:"This can lead to data leaks. Please use a SSL certificate"},{name_success:"Application is running as '"+Object(s.G)(t,["constant","user","value"])+"'",name_failure:"Application is running as root",pass:"root"!==Object(s.G)(t,["constant","user","value"]),severe:!0,message:"This is dangerous, you should use another user with less privileges"},{name_success:"Emacs is installed",name_failure:"Emacs is not installed",pass:Object(s.G)(t,["constant","emacs","value"]),severe:!1,message:"If you want to use all the org-mode features of Filestash, you need to install emacs"},{name_success:"Pdftotext is installed",name_failure:"Pdftotext is not installed",pass:Object(s.G)(t,["constant","pdftotext","value"]),severe:!1,message:"You won't be able to search through PDF documents without it"}]})).catch((function(t){s.F.send(t&&t.message,"error"),e.setState({busy:!1})}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"component_setup"},r.a.createElement(J,{loading:this.state.busy,onAdminPassword:this.onAdminPassword.bind(this),summaryCall:this.summaryCall.bind(this)}))}}]),n}(),J=function(e){L(n,r.a.Component);var t=M(n);function n(e){var r;return F(this,n),(r=t.call(this,e)).state={current:parseInt(window.location.hash.replace("#",""))||0,answer_password:"",has_answered_password:!1,deps:[]},r.$input=Object(a.createRef)(),r}return D(n,[{key:"componentDidMount",value:function(){var e=this;1===this.state.current&&this.props.summaryCall().then((function(t){e.setState({deps:t})}))}},{key:"onAdminPassword",value:function(e){var t=this;e.preventDefault(),this.props.onAdminPassword(this.state.answer_password,(function(){t.setState({has_answered_password:!0}),t.onStepChange(1)}))}},{key:"onStepChange",value:function(e){var t=this;this.setState({current:e},(function(){1===e&&t.componentDidMount()}))}},{key:"render",value:function(){var e=this,t=r.a.createElement("style",{dangerouslySetInnerHTML:{__html:".component_menu_sidebar{transform: translateX(-300px)}"}});return 0===this.state.current?r.a.createElement("div",{id:"step1"},r.a.createElement(q,{navleft:!1,navright:!0===this.state.has_answered_password,current:this.state.current,onStepChange:this.onStepChange.bind(this)},"Admin Password"),r.a.createElement(T.a,{transitionName:"stepper-form",transitionEnterTimeout:600,transitionAppearTimeout:600,transitionAppear:!0,transitionEnter:!0,transitionLeave:!1},r.a.createElement("div",{key:this.state.current},r.a.createElement("p",null,"Create your instance admin password: "),r.a.createElement("form",{onSubmit:this.onAdminPassword.bind(this)},r.a.createElement(c.s,{ref:this.$input,type:"password",placeholder:"Password",onChange:function(t){return e.setState({answer_password:t.target.value})},value:this.state.answer_password}),r.a.createElement(c.d,{theme:"transparent"},r.a.createElement(c.r,{name:this.props.loading?"loading":"arrow_right"}))))),t):1===this.state.current?r.a.createElement("div",{id:"step2"},r.a.createElement(q,{navleft:!0,navright:!1,current:this.state.current,onStepChange:this.onStepChange.bind(this)},"Summary"),r.a.createElement(T.a,{transitionName:"stepper-form",transitionEnterTimeout:600,transitionAppearTimeout:600,transitionAppear:!0,transitionEnter:!0,transitionLeave:!1},r.a.createElement("div",{key:this.state.current},r.a.createElement(c.B,{cond:!!this.props.loading},r.a.createElement(c.t,null),r.a.createElement("div",{style:{textAlign:"center"}},"Verifying")),r.a.createElement(c.B,{cond:!this.props.loading},this.state.deps.map((function(e,t){return r.a.createElement("div",{className:"component_dependency_installed"+(e.pass?" yes":" no")+(e.severe?" severe":""),key:t},r.a.createElement("span",null,e.pass?e.name_success:e.name_failure),e.pass?null:": "+e.message)})))))):null}}]),n}(),q=function(e){return r.a.createElement("h4",null,!0===e.navleft&&r.a.createElement(c.r,{name:"arrow_left",onClick:function(){return e.onStepChange(e.current-1)}}),e.children,!0===e.navright&&r.a.createElement(c.r,{name:"arrow_right",onClick:function(){return e.onStepChange(e.current+1)}}))};function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o=[],i=!0,c=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(c)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function W(e){var t=e.reload,n=void 0===t?s.E:t,o=$(Object(a.useState)(!1),2),i=o[0],u=o[1],d=$(Object(a.useState)(!1),2),m=d[0],f=d[1],b=Object(a.useRef)(null);return Object(a.useEffect)((function(){b.current.ref.focus()}),[]),r.a.createElement(c.g,{maxWidth:"300px",className:"sharepage_component"},r.a.createElement("form",{className:m?"error":"",onSubmit:function(e){e.preventDefault(),u(!0),l.a.login(b.current.ref.value).then((function(){return n()})).catch((function(){b.current.ref.value="",u(!1),f(!0),setTimeout((function(){f(!1)}),500)}))},style:{marginTop:"".concat(parseInt(window.innerHeight/3),"px")}},r.a.createElement(c.s,{ref:b,type:"password",placeholder:Object(p.a)("Password")}),r.a.createElement(c.d,{theme:"transparent"},r.a.createElement(c.r,{name:i?"loading":"arrow_right"}))))}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o=[],i=!0,c=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);i=!0);}catch(e){c=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(c)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Y(e){return r.a.createElement("div",{className:"component_menu_sidebar no-select"},e.isLoading?r.a.createElement("div",{className:"header"},r.a.createElement(c.r,{name:"arrow_left",style:{opacity:0}}),r.a.createElement(c.r,{name:"loading"})):r.a.createElement(i.c,{to:"/",className:"header"},r.a.createElement(c.r,{name:"arrow_left"}),r.a.createElement("img",{src:"/assets/logo/android-chrome-512x512.png"})),r.a.createElement("h2",null,"Admin console"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(i.c,{activeClassName:"active",to:e.url+"/backend"},"Backend")),r.a.createElement("li",null,r.a.createElement(i.c,{activeClassName:"active",to:e.url+"/settings"},"Settings")),r.a.createElement("li",null,r.a.createElement(i.c,{activeClassName:"active",to:e.url+"/logs"},"Logs"))))}t.default=function(e){var t=null;return function(n){var o=X(Object(a.useState)(t),2),i=o[0],u=o[1],p=function(){l.a.isAdmin().then((function(e){t=e,u(e)})).catch((function(e){s.F.send("Error: "+(e&&e.message),"error")}))};return Object(a.useEffect)((function(){p();var e=window.setInterval(p,5e3);return function(){return clearInterval(e)}}),[]),!0===i||/\/admin\/setup$/.test(location.pathname)?r.a.createElement(e,n):!1===i?r.a.createElement(W,{reload:p}):r.a.createElement(c.u,null)}}((function(e){var t=Object(o.h)(),n=X(Object(a.useState)(!1),2),i=n[0],l=n[1];return r.a.createElement("div",{className:"component_page_admin"},r.a.createElement(Y,{url:t.url,isLoading:i}),r.a.createElement("div",{className:"page_container scroll-y"},r.a.createElement(c.e,{key:location.pathname,transitionName:"adminpage",transitionAppearTimeout:3e4},r.a.createElement(o.d,null,r.a.createElement(o.b,{path:t.url+"/backend",render:function(){return r.a.createElement(O,{isSaving:l})}}),r.a.createElement(o.b,{path:t.url+"/settings",render:function(){return r.a.createElement(C,{isSaving:l})}}),r.a.createElement(o.b,{path:t.url+"/logs",render:function(){return r.a.createElement(P,{isSaving:l})}}),r.a.createElement(o.b,{path:t.url+"/setup",component:z}),r.a.createElement(o.b,{path:t.url,component:u})))))}))}}]);